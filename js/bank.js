function formatBin(bin) {
    const binStr = bin.toString().replace(/\D/g, '');
    return binStr.padStart(6, '0').slice(0, 6);
}
const bankCodes = {
    "中国工商银行": "102391052923",
    "中国建设银行": "105391002146",
    "中国农业银行": "103391010535",
    "中国银行": "104391013011",
    "交通银行": "301391000034",
    "中信银行": "302391061257",
    "光大银行": "303391000047",
    "华夏银行": "304391042219",
    "中国民生银行": "305391015023",
    "广发银行": "306391000025",
    "招商银行": "308391026108",
    "兴业银行": "309391000062",
    "浦发银行": "310391000029",
    "平安银行": "307391024173",
    "福建农商银行": "314391011355",
    "浙江稠州商业银行": "313391035602",
    "厦门国际银行": "781391020021",
    "厦门银行": "313391090141",
    "恒欣银行": "320391000019"
};
const bankData = (() => {
    const icbcBins = ["370246", "370248", "370249", "427010", "427018", "427019", "427020", "427029", "427030", "427039", "370247", "438125", "438126", "451804", "451810", "451811", formatBin("45806"), "458071", "489734", "489735", "489736", "427062", "427064", "530970", formatBin("53098"), "530990", "558360", "620200", "620302", "620402", "620403", "620404", "524047", "620406", "620407", "525498", "620409", "620410", "620411", "620412", "620502", "620503", "620405", "620408", "620512", "620602", "620604", "620607", "620611", "620612", "620704", "620706", "620707", "620708", "620709", "620710", "620609", "620712", "620713", "620714", "620802", "620711", "620904", "620905", "621001", "620902", "621103", "621105", "621106", "621107", "621102", "621203", "621204", "621205", "621206", "621207", "621208", "621209", "621210", "621302", "621303", "621202", "621305", "621306", "621307", "621309", "621311", "621313", "621211", "621315", "621304", "621402", "621404", "621405", "621406", "621407", "621408", "621409", "621410", "621502", "621317", "621511", "621602", "621603", "621604", "621605", "621608", "621609", "621610", "621611", "621612", "621613", "621614", "621615", "621616", "621617", "621607", "621606", "621804", "621807", "621813", "621814", "621817", "621901", "621904", "621905", "621906", "621907", "621908", "621909", "621910", "621911", "621912", "621913", "621915", "622002", "621903", "622004", "622005", "622006", "622007", "622008", "622010", "622011", "622012", "621914", "622015", "622016", "622003", "622018", "622019", "622020", "622102", "622103", "622104", "622105", "622013", "622111", "622114", "622017", "622210", "622211", "622212", "622213", "622214", "622110", "622220", "622223", "622225", "622229", "622230", "622231", "622232", "622233", "622234", "622235", "622237", "622215", "622239", "622240", "622245", "622224", "622304", "622306", "622238", "622314", "622317", "622402", "622403", "622404", "622313", "622504", "622505", "622513", "622502", "622604", "622605", "622606", "622703", "622715", "622903", "622706", "623002", "623006", "623008", "623011", "623012", "622904", "623015", "623100", "623202", "623301", "623400", "623500", "623602", "623803", "623901", "623014", "624100", "624200", "624301", "624402", formatBin("62451804"), formatBin("62451810"), formatBin("62451811"), formatBin("6245806"), formatBin("62458071"), formatBin("62453098"), "623700", "628288", "624000", formatBin("9558"), "628286", "622206", "526836", "513685", "543098", "458441", "622246", formatBin("900000"), "544210", "548943", "370267", "621558", "621559", "621722", "621723", "621226", "402791", "427028", "427038", "548259", "356879", "356880", "356881", "356882", "528856", "620516", "621721", formatBin("900010"), "625330", "625331", "625332", "622236", "524374", "550213", "621288", "625708", "625709", "622597", "622599", "360883", "360884", "625865", "625866", "625899", "374738", "374739", "510529", "524091", "625650", "622910", "622911", "622912", "622913", "625858", "625859", "625860", "625160", "625161", "625162", "620086", "621670", "623260", formatBin("620058"), "621225", "621227", "621281", "621618", "622200", "622202", "622203", "622208", "623062", "623271", "623272", "621218", "621475", "621476", "623229", "625929", "621376", formatBin("620054"), formatBin("620142"), "621423", "625927", "621428", "625939", "621434", "625987", "621761", "621749", formatBin("620184"), "625930", "623321", "621300", "621378", "625114", "622159", "621720", "625021", "625022", "625932", "621379", formatBin("620114"), formatBin("620146"), "622889", "625900", "622949", "625915", "625916", formatBin("620030"), formatBin("620050"), "622944", "625115", formatBin("620101"), "623335", "625941", "625801", "622171", "621240", "621724", "625931", "621762", "625918", "625113", "621371", formatBin("620143"), formatBin("620149"), formatBin("62137310"), formatBin("62137320"), formatBin("62592310"), formatBin("62592320"), formatBin("62592340"), formatBin("62013101"), formatBin("62013102"), "621730", "625928", "621414", "625914", "621375", formatBin("620187"), "621734", "621433", "625986", "621370", "625925", "622926", "622927", "622928", "622929", "622930", "622931", "621733", "621732", formatBin("620124"), formatBin("620183"), formatBin("620561"), "625116", "622227", "625921", "621764", "625926", "621372", "623034", "625110", "621464", "625942", formatBin("62594250"), formatBin("62594260"), formatBin("62594270"), "622158", "625917", "621765", formatBin("620094"), formatBin("620186"), "621719", "625922", "621369", "621763", "625934", formatBin("620046"), "621750", "625933", "621377", formatBin("620148"), formatBin("620185"), "625920", "621367", "625924", "621374", "621731", "621781", "621230", "621229", "625017", "625018", "625019", "625651", formatBin("62844801"), "622299", "625247"];
    const abcBins = ["552599", "6349102", "6353591", "623206", "621671", "620059", "403361", "404117", "404118", "404119", "404120", "404121", "463758", "49102", "514027", "519412", "519413", "520082", "520083", "53591", "558730", "621282", "621336", "621619", "622821", "622822", "622823", "622824", "622825", "622826", "622827", "622828", "622836", "622837", "622840", "622841", "622843", "622844", "622845", "622846", "622847", "622848", "622849", "623018", "625996", "625997", "625998", "628268", "95595", "95596", "95597", "95598", "95599", "622839", "625826", "625827", "548478", "544243", "622820", "622830", "622838", "625336", "628269", "625653", "628346", "625171", "625170", "623052", "623050", "623053", "623056", formatBin("62844803"), "625818"];
    const bocBins = ["621660", "621661", "621663", "621667", "621668", "621666", "356833", "356835", "409665", "409666", "409668", "409669", "409670", "409671", "409672", "456351", "512315", "512316", "512411", "512412", "514957", "409667", "518378", "518379", "518474", "518475", "518476", "438088", "524865", "525745", "525746", "547766", "552742", "553131", "558868", "514958", "622752", "622753", "622755", "524864", "622757", "622758", "622759", "622760", "622761", "622762", "622763", "601382", "622756", "628388", "621256", "621212", "620514", "622754", "518377", "622788", "621283", "620061", "621725", "620040", "558869", "621330", "621331", "621332", "621333", "621297", "377677", "621568", "621569", "625905", "625906", "625907", "628313", "625333", "628312", "623208", "621620", "621756", "621757", "621758", "621759", "621785", "621786", "621787", "621788", "621789", "621790", "621672", "625337", "625338", "625568", "621669", "621662", "623571", "623572", "623575", "623263", "623184", "623569", "623586", "625834", "623573", "621665", "627025", "627026", "627027", "627028", "622764", "622765", "625908", "625909", "625910", "620025", "620026", "621293", "621294", "621342", "621343", "621364", "621394", "621648", "621248", "621215", "621249", "622771", "622772", "622770", "620531", "620210", "620211", "622479", "622480", "622273", "622274", "622380", "626200", "620019", "620035", "621231", "622789", "621638", "621334", "625140", "621395", "620513", "621741", "623040", "620202", "620203", "621782", "623309", "622346", "622347", "622348", "621041", "622790", "6227890", "6227891", "6227892", "6227893", "6227894", "6227895", "6227896", "6227897", "6227898", "6227899", "624405", formatBin("62844802")];
    const bocmBins = ["620021", "620521", "00405512", "0049104", "0053783", "00601428", "405512", "434910", "458123", "458124", "49104", "520169", "522964", "53783", "552853", "601428", "622250", "622251", "521899", "622254", "622255", "622256", "622257", "622258", "622259", "622253", "622261", "622284", "622656", "628216", "622252", "66405512", "6649104", "622260", "66601428", "955590", "955591", "955592", "955593", "6653783", "628218", "622262", "621002", "621069", "620013", "625028", "625029", "621436", "621335"];
    const citicBins = ["433670", "433680", "442729", "442730", "620082", "622690", "622691", "622692", "622696", "622698", "622998", "622999", "433671", "968807", "968808", "968809", "621771", "621767", "621768", "621770", "621772", "621773", "620527", "621769", "623280", "376968", "376969", "400360", "403391", "403392", "376966", "404158", "404159", "404171", "404172", "404173", "404174", "404157", "433667", "433669", "514906", "403393", "520108", "433666", "558916", "622679", "622680", "622688", "622689", "628206", "556617", "628209", "518212", "628208", "356390", "356391", "356392", "622916", "622918", "622919", "628370", "628371", "628372", "622766", "622767", "622768", "622678"];
    const everbrightBins = ["356837", "356838", "486497", "622660", "622662", "622663", "622664", "622665", "622666", "622667", "622669", "622670", "622671", "622672", "622668", "622661", "622674", "90030", "622673", "620518", "621489", "621492", "620535", "623156", "621490", "621491", "620085", "623155", "623157", "623158", "623159", "623253", "622657", "622685", "622659", "622687", "625981", "625979", "356839", "356840", "406252", "406254", "425862", "481699", "524090", "543159", "622161", "622570", "622650", "622655", "622658", "625975", "625977", "628201", "628202", "625976", "625339", "622801", "625978", "625980", "625974"];
    const huaxiaBins = ["999999", "621222", "623020", "623021", "623022", "623023", "622630", "622631", "622632", "622633", "620552", "523959", "528709", "539867", "539868", "622637", "622638", "628318", "528708", "622636", "625967", "625968", "625969", "623292"];
    const minshengBins = ["622615", "622616", "622618", "622622", "622617", "622619", "415599", "421393", "421865", "427570", "427571", "472067", "472068", "622620", "621691", "623255", "900003", "623258", "623683", "545392", "545393", "545431", "545447", "356859", "356857", "407405", "421869", "421870", "421871", "512466", "356856", "528948", "552288", "622600", "622601", "622602", "517636", "622621", "628258", "556610", "622603", "464580", "464581", "523952", "545217", "553161", "356858", "622623", "625911", "377152", "377153", "377158", "377155", "625912", "625913", "625188", "621692"];
    const gfBins = ["406365", "406366", "428911", "436768", "436769", "487013", "491032", "491034", "491035", "491036", "491037", "491038", "518364", "520152", "520382", "548844", "552794", "622555", "622556", "622557", "622558", "622559", "622560", "622568", "528931", "9111", "558894", "625072", "625071", "628260", "628259", "621462", "625805", "625806", "625807", "625808", "625809", "625810", "685800", "620037", "6858000", "6858001", "6858009", "623506", "623259", "62364873"];
    const cmbBins = ["356885", "356886", "356887", "356888", "356890", "402658", "410062", "439188", "439227", "468203", "479228", "479229", "512425", "521302", "524011", "356889", "545620", "545621", "545947", "545948", "552534", "552587", "622575", "622576", "622577", "622578", "622579", "622580", "545619", "622581", "622582", "622588", "622598", "622609", "690755", "690755", "95555", "545623", "621286", "620520", "621483", "621485", "621486", "370285", "370286", "370287", "370289", "439225", "518710", "518718", "628362", "439226", "628262", "621299"];
    const cibBins = ["90592", "966666", "622909", "622908", "438588", "438589", "461982", "486493", "486494", "486861", "523036", "451289", "527414", "528057", "622901", "622902", "622922", "628212", "451290", "524070", "625084", "625085", "625086", "625087", "548738", "549633", "552398", "625082", "625083", "625960", "625961", "625962", "625963", "625353", "625356", "622571", "622572", "622573", "622591", "622592", "622593", "621245", "623287"];
    const spdbBins = ["356851", "356852", "404738", "404739", "456418", "498451", "515672", "356850", "517650", "525998", "622177", "622277", "622516", "622517", "622518", "622520", "622521", "622522", "622523", "628222", "84301", "84336", "84373", "628221", "84390", "87000", "87010", "87030", "87040", "84380", "984301", "984303", "84361", "87050", "622176", "622276", "622228", "621351", "621390", "621792", "625957", "625958", "621791", "84342", "620530", "625993", "622519", "621793", "621795", "621796", "622500", "623250", "621352", "84385", "625971", "625970", "377187", "625831", "622693", "625833"];
    const bankMap = {};
    const processBankBins = (bins, bankName) => {
        bins.forEach(bin => {
            const bin6 = formatBin(bin);
            bankMap[bin6] = { 
                name: bankName, 
                code: bankCodes[bankName] || "暂无行号" 
            };
        });
    };
    processBankBins(icbcBins, "中国工商银行");
    processBankBins(abcBins, "中国农业银行");
    processBankBins(bocBins, "中国银行");
    processBankBins(bocmBins, "交通银行");
    processBankBins(citicBins, "中信银行");
    processBankBins(everbrightBins, "光大银行");
    processBankBins(huaxiaBins, "华夏银行");
    processBankBins(minshengBins, "中国民生银行");
    processBankBins(gfBins, "广发银行");
    processBankBins(cmbBins, "招商银行");
    processBankBins(cibBins, "兴业银行");
    processBankBins(spdbBins, "浦发银行");
    return bankMap;
})();
const cardBinInput = document.getElementById('cardBin');
const bankNameDisplay = document.getElementById('bankName');
const bankCodeDisplay = document.getElementById('bankCode');
const statusMessage = document.getElementById('statusMessage');
const bankButtons = document.querySelectorAll('.bank-btn');
function showStatus(message, type) {
    statusMessage.textContent = message;
    statusMessage.classList.remove('hidden', 'bg-success/10', 'bg-warning/10', 'bg-danger/10', 'text-success', 'text-warning', 'text-danger');
    if (type === 'success') {
        statusMessage.classList.add('bg-success/10', 'text-success');
        statusMessage.innerHTML = `<i class="fa fa-check-circle mr-2"></i>${message}`;
    } else if (type === 'warning') {
        statusMessage.classList.add('bg-warning/10', 'text-warning');
        statusMessage.innerHTML = `<i class="fa fa-exclamation-circle mr-2"></i>${message}`;
    } else if (type === 'error') {
        statusMessage.classList.add('bg-danger/10', 'text-danger');
        statusMessage.innerHTML = `<i class="fa fa-times-circle mr-2"></i>${message}`;
    }
    statusMessage.classList.remove('hidden');
    setTimeout(() => {
        statusMessage.classList.add('hidden');
    }, 5000);
}
function identifyBank(cardBin) {
    cardBin = cardBin.replace(/\D/g, '');
    bankNameDisplay.innerHTML = '<span class="text-gray-400 italic">等待输入...</span>';
    bankCodeDisplay.innerHTML = '<span class="text-gray-400 italic">等待识别...</span>';
    if (cardBin.length === 0) {
        showStatus('请输入银行卡号前6位数字', 'warning');
        return;
    }
    if (cardBin.length < 6) {
        showStatus(`当前输入${cardBin.length}位，请输入完整的6位数字`, 'warning');
        return;
    }
    if (!/^\d{6}$/.test(cardBin)) {
        showStatus('请输入有效的6位数字', 'error');
        return;
    }
    if (bankData[cardBin]) {
        bankNameDisplay.innerHTML = `<span class="text-primary font-medium">${bankData[cardBin].name}</span>`;
        bankCodeDisplay.innerHTML = `<span class="text-gray-800 font-mono">${bankData[cardBin].code}</span>`;
        showStatus(`成功识别：${bankData[cardBin].name}`, 'success');
    } else {
        bankNameDisplay.innerHTML = '<span class="text-danger">未识别到该银行</span>';
        bankCodeDisplay.innerHTML = '<span class="text-gray-500">暂无数据</span>';
        showStatus('未找到该BIN对应的银行信息', 'error');
    }
}
cardBinInput.addEventListener('input', function() {
    identifyBank(this.value);
});
cardBinInput.addEventListener('keydown', function(e) {
    const allowedKeys = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'Backspace', 'Delete', 'ArrowLeft', 'ArrowRight', 'Tab'];
    if (!allowedKeys.includes(e.key) && !e.ctrlKey && !e.metaKey) {
        e.preventDefault();
    }
});
bankButtons.forEach(button => {
    button.addEventListener('click', function() {
        const bin = this.getAttribute('data-bin');
        cardBinInput.value = bin;
        identifyBank(bin);
        this.classList.add('bg-primary/20');
        setTimeout(() => {
            this.classList.remove('bg-primary/20');
        }, 300);
        cardBinInput.focus();
    });
});
cardBinInput.focus();